/*C6*/SET SCHEMA PUBLIC
alter table TMECANICOS add CONSTRAINT UNIQUE_DNI UNIQUE(DNI)
CREATE TABLE TCATEGORIACONTRATOS (\u000a\u0009CATEGORIA_ID INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1, INCREMENT BY 1),\u000a\u0009NOMBRE VARCHAR(50) NOT NULL,\u000a\u0009TRIENIO_SALARIO DOUBLE NOT NULL,\u000a\u0009PRODUCTIVIDAD_PLUS DOUBLE NOT NULL,\u000a\u0009CONSTRAINT PK_CATEGORY PRIMARY KEY (CATEGORIA_ID)\u000a)
CREATE TABLE TTIPOCONTRATOS (\u000a\u0009TIPO_ID INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1, INCREMENT BY 1),\u000a\u0009NOMBRE VARCHAR(50) NOT NULL,\u000a\u0009DIAS_COMPENSACION_POR_A\u00d1O DOUBLE NOT NULL,\u000a\u0009CONSTRAINT PK_TYPE PRIMARY KEY (TIPO_ID)\u0009\u000a)
CREATE TABLE TCONTRATOS (\u000a\u0009CONTRATO_ID INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1, INCREMENT BY 1),\u000a\u0009MECANICO_ID INTEGER NOT NULL,\u000a\u0009TIPO_ID INTEGER NOT NULL,\u000a\u0009CATEGORIA_ID INTEGER NOT NULL,\u000a\u0009FECHA_INICIAL DATE NOT NULL,\u000a\u0009FECHA_FIN DATE,\u000a\u0009SALARIO_BASE_ANUAL DOUBLE NOT NULL,\u000a\u0009COMPENSACION DOUBLE NOT NULL,\u000a\u0009STATUS VARCHAR(10) NOT NULL,\u000a\u0009CONSTRAINT PK_CONTRACT PRIMARY KEY (CONTRATO_ID),\u000a\u0009CONSTRAINT FK_MECHANIC FOREIGN KEY (MECANICO_ID) REFERENCES TMECANICOS(ID),\u000a\u0009CONSTRAINT FK_TYPE FOREIGN KEY (TIPO_ID) REFERENCES TTIPOCONTRATOS(TIPO_ID),\u000a\u0009CONSTRAINT FK_CATEGORY FOREIGN KEY (CATEGORIA_ID) REFERENCES TCATEGORIACONTRATOS(CATEGORIA_ID),\u000a\u0009CONSTRAINT CHECK_CONTRACT_ESTADO CHECK (STATUS IN ('ACTIVE', 'FINISHED'))\u000a)
CREATE TABLE TNOMINAS(\u000a\u0009NOMINA_ID INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1, INCREMENT BY 1),\u000a\u0009FECHA_N DATE NOT NULL,\u000a\u0009SALARIO_BASE DOUBLE NOT NULL,\u000a\u0009SALARIO_EXTRA DOUBLE NOT NULL,\u000a\u0009PRODUCTIVIDAD DOUBLE NOT NULL,\u000a\u0009TRIENIO DOUBLE NOT NULL,\u000a\u0009IRPF DOUBLE NOT NULL,\u000a\u0009SEGURIDAD_SOCIAL DOUBLE NOT NULL,\u000a\u0009CONTRATO_ID INTEGER NOT NULL,\u000a\u0009TOTAL_BRUTO DOUBLE,\u000a\u0009TOTAL_DESCUENTOS DOUBLE, \u000a\u0009TOTAL_NETO DOUBLE,\u000a\u0009CONSTRAINT PK_PAYROLL PRIMARY KEY (NOMINA_ID),\u000a\u0009CONSTRAINT FK_CONTRACT FOREIGN KEY (CONTRATO_ID) REFERENCES TCONTRATOS(CONTRATO_ID),\u000a\u0009CONSTRAINT UNIQUE_PAYROLL UNIQUE (CONTRATO_ID, FECHA_N)\u000a)
INSERT INTO TTIPOCONTRATOS VALUES(1,'INDEFINIDOS',5000.0E0)
COMMIT
INSERT INTO TTIPOCONTRATOS VALUES(2,'OBRA',2500.0E0)
COMMIT
INSERT INTO TTIPOCONTRATOS VALUES(3,'TEMPORALES',1000.0E0)
COMMIT
INSERT INTO TCATEGORIACONTRATOS VALUES(1,'Jefes',1067.4E0,0.8E0)
COMMIT
INSERT INTO TCATEGORIACONTRATOS VALUES(2,'Peon',885.3E0,0.5E0)
COMMIT
INSERT INTO TCATEGORIACONTRATOS VALUES(3,'Ayudante',770.1E0,0.3E0)
COMMIT
INSERT INTO TCONTRATOS VALUES(1,1,1,1,'2015-10-01',NULL,5000.0E0,0.0E0,'ACTIVE')
COMMIT
INSERT INTO TCONTRATOS VALUES(2,2,2,3,'2018-08-01','2018-12-31',2000.0E0,0.0E0,'ACTIVE')
COMMIT
INSERT INTO TCONTRATOS VALUES(3,3,2,3,'2018-09-01','2018-09-30',800.0E0,0.0E0,'FINISHED')
COMMIT
INSERT INTO TCONTRATOS VALUES(4,4,2,3,'2018-08-01','2018-09-30',800.0E0,0.0E0,'FINISHED')
COMMIT
INSERT INTO TCONTRATOS VALUES(5,5,3,3,'2018-09-01','2018-10-30',1000.0E0,0.0E0,'ACTIVE')
COMMIT
INSERT INTO TCONTRATOS VALUES(6,4,2,2,'2018-10-01',NULL,1200.0E0,0.0E0,'ACTIVE')
COMMIT
DELETE FROM TSUSTITUCIONES WHERE INTERVENCION_AVERIA_ID=1 AND INTERVENCION_MECANICO_ID=4 AND REPUESTO_ID=3
DELETE FROM TSUSTITUCIONES WHERE INTERVENCION_AVERIA_ID=2 AND INTERVENCION_MECANICO_ID=1 AND REPUESTO_ID=4
DELETE FROM TSUSTITUCIONES WHERE INTERVENCION_AVERIA_ID=2 AND INTERVENCION_MECANICO_ID=1 AND REPUESTO_ID=7
DELETE FROM TSUSTITUCIONES WHERE INTERVENCION_AVERIA_ID=2 AND INTERVENCION_MECANICO_ID=1 AND REPUESTO_ID=20
DELETE FROM TSUSTITUCIONES WHERE INTERVENCION_AVERIA_ID=2 AND INTERVENCION_MECANICO_ID=1 AND REPUESTO_ID=21
DELETE FROM TSUSTITUCIONES WHERE INTERVENCION_AVERIA_ID=4 AND INTERVENCION_MECANICO_ID=4 AND REPUESTO_ID=18
DELETE FROM TSUSTITUCIONES WHERE INTERVENCION_AVERIA_ID=5 AND INTERVENCION_MECANICO_ID=2 AND REPUESTO_ID=1
DELETE FROM TSUSTITUCIONES WHERE INTERVENCION_AVERIA_ID=5 AND INTERVENCION_MECANICO_ID=2 AND REPUESTO_ID=10
DELETE FROM TSUSTITUCIONES WHERE INTERVENCION_AVERIA_ID=8 AND INTERVENCION_MECANICO_ID=3 AND REPUESTO_ID=11
DELETE FROM TSUSTITUCIONES WHERE INTERVENCION_AVERIA_ID=9 AND INTERVENCION_MECANICO_ID=5 AND REPUESTO_ID=9
DELETE FROM TSUSTITUCIONES WHERE INTERVENCION_AVERIA_ID=10 AND INTERVENCION_MECANICO_ID=5 AND REPUESTO_ID=16
COMMIT
DELETE FROM TINTERVENCIONES WHERE AVERIA_ID=1 AND MECANICO_ID=4
DELETE FROM TINTERVENCIONES WHERE AVERIA_ID=2 AND MECANICO_ID=1
DELETE FROM TINTERVENCIONES WHERE AVERIA_ID=3 AND MECANICO_ID=2
DELETE FROM TINTERVENCIONES WHERE AVERIA_ID=4 AND MECANICO_ID=4
DELETE FROM TINTERVENCIONES WHERE AVERIA_ID=5 AND MECANICO_ID=2
DELETE FROM TINTERVENCIONES WHERE AVERIA_ID=6 AND MECANICO_ID=1
DELETE FROM TINTERVENCIONES WHERE AVERIA_ID=7 AND MECANICO_ID=5
DELETE FROM TINTERVENCIONES WHERE AVERIA_ID=8 AND MECANICO_ID=3
DELETE FROM TINTERVENCIONES WHERE AVERIA_ID=9 AND MECANICO_ID=5
DELETE FROM TINTERVENCIONES WHERE AVERIA_ID=10 AND MECANICO_ID=5
COMMIT
DELETE FROM TAVERIAS WHERE ID=1
INSERT INTO TAVERIAS VALUES(1,'Aire acondicionado','2018-09-05',80.0E0,'ABIERTA',1,NULL,11)
COMMIT
DELETE FROM TAVERIAS WHERE ID=2
INSERT INTO TAVERIAS VALUES(2,'Motor','2018-09-15',1500.0E0,'ABIERTA',2,NULL,12)
COMMIT
DELETE FROM TAVERIAS WHERE ID=3
INSERT INTO TAVERIAS VALUES(3,'Junta de una culata','2018-09-30',400.0E0,'ABIERTA',3,NULL,15)
COMMIT
DELETE FROM TAVERIAS WHERE ID=4
INSERT INTO TAVERIAS VALUES(4,'Luna rota','2018-10-01',100.0E0,'ABIERTA',4,NULL,20)
COMMIT
DELETE FROM TAVERIAS WHERE ID=5
INSERT INTO TAVERIAS VALUES(5,'Cambio de defensa','2018-09-10',1000.0E0,'ABIERTA',5,NULL,25)
COMMIT
DELETE FROM TAVERIAS WHERE ID=6
INSERT INTO TAVERIAS VALUES(6,'Cambio de frenos','2018-09-19',250.0E0,'ABIERTA',6,NULL,11)
COMMIT
INSERT INTO TINTERVENCIONES VALUES(30,1,1)
COMMIT
INSERT INTO TINTERVENCIONES VALUES(340,2,2)
COMMIT
INSERT INTO TINTERVENCIONES VALUES(100,3,3)
COMMIT
INSERT INTO TINTERVENCIONES VALUES(60,4,4)
COMMIT
INSERT INTO TINTERVENCIONES VALUES(180,5,5)
COMMIT
INSERT INTO TINTERVENCIONES VALUES(65,6,1)
COMMIT
